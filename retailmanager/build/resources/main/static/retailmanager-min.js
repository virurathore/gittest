function ConvertFormToShopJSON(a){a=jQuery(a).serializeArray();var c={},b={};jQuery.each(a,function(){"shopName"==this.name?c[this.name]=this.value||"":b[this.name]=this.value||""});c.shopAddress=b;return JSON.stringify(c)}
function addRow(a,c){console.log(c);var b="\x3ctr\x3e";console.log(" row data : "+JSON.stringify(a));b+="\x3ctd\x3e"+a.shopsName+"\x3c/td\x3e";b+="\x3ctd\x3e"+a.shopAddress.number+"\x3c/td\x3e";b+="\x3ctd\x3e"+a.shopAddress.postCode+"\x3c/td\x3e";b+="\x3ctd\x3e"+a.shopLongitude+"\x3c/td\x3e";b+="\x3ctd\x3e"+a.shopLatitude+"\x3c/td\x3e";c.append(b+"\x3c/tr\x3e")}
function listPageShow(a){console.log("listing data");$.ajax({type:"GET",url:"/api/shops?all\x3d1"}).done(function(c){console.log("get all result "+c);console.log("not result "+!c);console.log("result length"+c.length);if(c&&0<c.length){$("#listTable \x3e tbody").empty();var a=jQuery("#listTable \x3e tbody");console.log("success");for(var d=0;d<c.length;++d)addRow(c[d],a)}else alert("No shop in system")}).fail(function(){alert("unable to retrive data from server, try again")})}
$(function(){$("[data-role\x3d'header'], [data-role\x3d'footer']").toolbar();$("#myTable \x3e tbody").empty()});
jQuery(document).on("ready",function(){$("#nav_list").bind("click",listPageShow);jQuery("form#search-shop").bind("submit",function(a){a.preventDefault();a="/api/shops?"+$(this).serialize();$.ajax({type:"GET",url:a}).done(function(a){if(a&&0<a.length){$("#searchTable \x3e tbody").empty();var b=jQuery("#searchTable \x3e tbody");console.log("success");for(var d=0;d<a.length;++d)addRow(a[d],b)}else alert("No shop found near by")}).fail(function(){alert("unable to retrive data from server, try again");
console.log("failed")})});jQuery("form#add-new-shop").bind("submit",function(a){a.preventDefault();a=ConvertFormToShopJSON(this);console.log("json :"+a);$.ajax({type:"POST",url:"/api/shops",data:a,contentType:"application/json; charset\x3dutf-8",dataType:"json"}).done(function(a){console.log("success");if(a){$("#addTable \x3e tbody").empty();var b=jQuery("#addTable \x3e tbody");addRow(a,b)}}).fail(function(){alert("unable to save data to server, try again")});return!0})});